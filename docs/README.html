<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>ljson – Line JSON &mdash; lson 0.1.1 documentation</title>
    
    <link rel="stylesheet" href="static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <link rel="top" title="lson 0.1.1 documentation" href="index.html" />
    <link rel="next" title="Quickstart" href="guide/guide.html" />
    <link rel="prev" title="Welcome to lson’s documentation!" href="index.html" />
   
  <link rel="stylesheet" href="static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="ljson-line-json">
<h1><a class="toc-backref" href="#id1">ljson &#8211; Line JSON</a><a class="headerlink" href="#ljson-line-json" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#ljson-line-json" id="id1">ljson &#8211; Line JSON</a><ul>
<li><a class="reference internal" href="#quicklinks" id="id2">Quicklinks</a></li>
<li><a class="reference internal" href="#build-and-test-status" id="id3">Build and Test Status</a></li>
<li><a class="reference internal" href="#what-is-ljson" id="id4">What is ljson?</a></li>
<li><a class="reference internal" href="#why-ljson" id="id5">Why ljson?</a></li>
<li><a class="reference internal" href="#design" id="id6">Design</a><ul>
<li><a class="reference internal" href="#header" id="id7">Header</a></li>
<li><a class="reference internal" href="#datatypes" id="id8">Datatypes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#usage" id="id9">Usage</a><ul>
<li><a class="reference internal" href="#without-a-python-module" id="id10">Without a Python Module</a></li>
<li><a class="reference internal" href="#with-the-ljson-module" id="id11">With the ljson Module</a></li>
<li><a class="reference internal" href="#using-ljson-to-store-data" id="id12">Using ljson to store data</a></li>
</ul>
</li>
<li><a class="reference internal" href="#todos" id="id13">Todos</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="quicklinks">
<h2><a class="toc-backref" href="#id2">Quicklinks</a><a class="headerlink" href="#quicklinks" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://daknuett.github.io/ljson">The Documentation</a></li>
<li><a class="reference external" href="https://github.com/daknuett/ljson">The github.com repo</a></li>
<li><a class="reference external" href="https://pypi.python.org/pypi/ljson/">The PyPi repo</a></li>
</ul>
</div>
<div class="section" id="build-and-test-status">
<h2><a class="toc-backref" href="#id3">Build and Test Status</a><a class="headerlink" href="#build-and-test-status" title="Permalink to this headline">¶</a></h2>
<a class="reference external image-reference" href="https://travis-ci.org/daknuett/ljson"><img alt="https://travis-ci.org/daknuett/ljson.svg?branch=master" src="https://travis-ci.org/daknuett/ljson.svg?branch=master" /></a>
</div>
<div class="section" id="what-is-ljson">
<h2><a class="toc-backref" href="#id4">What is ljson?</a><a class="headerlink" href="#what-is-ljson" title="Permalink to this headline">¶</a></h2>
<p>ljson is an attempt to create a database model suiting the
needs of modern data processing. It is designed to work
faster than usual json, but to keep the simple but yet
elegant object representation.</p>
<p>ljson can be used instead of pure json to increase the
performance when accessing a large set of data.</p>
</div>
<div class="section" id="why-ljson">
<h2><a class="toc-backref" href="#id5">Why ljson?</a><a class="headerlink" href="#why-ljson" title="Permalink to this headline">¶</a></h2>
<p>There are a <strong>lot</strong> data storage formats out there: XML,
JSON, CSV, SQL, NOSQL, binary packed, GNU-DB,...</p>
<p>Some of them are designed to store complete databases (SQL,
NOSQL, ...) and some are designed to store tables. And of
course there are JSON and XML. They can be used to store
more complex objects, are human-readable and data is stored
in just one file.</p>
<p>But they suffer from one problem: If one wants to alter the
data in the file he has to read the complete file and store
all the data in his RAM. This is slow, maybe impossible
(<em>Big Data</em>) and insecure. If the process cannot complete
the operation properly this might corrupt all data.</p>
<p>ljson tries to bypass this by using a mixture of CSV (line
based) and JSON (object based):</p>
<p>Every line is one object. If one wants to add another object
he just opens the file in append mode and adds one line. If
one line is corrupted the rest of the file is still valid.</p>
<p>Operating on large sets of objects is also possible by
reading the file line by line.</p>
<p>Especially asynchronous operations can be performed easily,
as the main part of the file stays untouched (unless you
alter objects. Then the file has to be re-written).</p>
</div>
<div class="section" id="design">
<h2><a class="toc-backref" href="#id6">Design</a><a class="headerlink" href="#design" title="Permalink to this headline">¶</a></h2>
<p>ljson is designed to be stored in files, the definition
of a ljson file is:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;ljson_file&gt; = [&lt;header&gt;\n]&lt;ljson_content&gt;
&lt;ljson_content&gt; = &lt;json_object&gt;{\n&lt;json_object&gt;}
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">&lt;json_object&gt;</span></code> can be any json object, as described on
<a class="reference external" href="http://json.org/">json.org</a>.</p>
<div class="section" id="header">
<h3><a class="toc-backref" href="#id7">Header</a><a class="headerlink" href="#header" title="Permalink to this headline">¶</a></h3>
<p>The header is a special json object that describes the data
in the file. A header must be in the following format:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;header&gt; = &quot;{ \&quot;__type__\&quot;: \&quot;header\&quot;,&quot; &lt;fieldname&gt;&quot;: {&quot; &quot;\&quot;type\&quot;:&quot; &lt;type&gt;&quot;, \&quot;modifiers\&quot;:&quot; &lt;modifiers&gt; &quot;}&quot;
&lt;type&gt; = &quot;\&quot;int\&quot;&quot; | &quot;\&quot;str\&quot;&quot; | &quot;\&quot;bool\&quot;&quot; | &quot;\&quot;float\&quot;&quot; | &quot;\&quot;null\&quot;&quot; | &quot;\&quot;bytes\&quot;&quot;
&lt;modifiers&gt; = &quot;[&quot; [&lt;modifier&gt; {&quot;,&quot;&lt;modifier&gt;}] &quot;]&quot;
&lt;modifier&gt; = &quot;\&quot;unique\&quot;&quot; | &quot;\&quot;not null\&quot;&quot;
</pre></div>
</div>
<p>The header is required by the on-disk implementation.</p>
</div>
<div class="section" id="datatypes">
<h3><a class="toc-backref" href="#id8">Datatypes</a><a class="headerlink" href="#datatypes" title="Permalink to this headline">¶</a></h3>
<p>If you use ljson you are restricted to the following python
data types (and their ljson types):</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">int</span></code>: <code class="docutils literal"><span class="pre">&quot;int&quot;</span></code></li>
<li><code class="docutils literal"><span class="pre">str</span></code>: <code class="docutils literal"><span class="pre">&quot;str&quot;</span></code></li>
<li><code class="docutils literal"><span class="pre">bool</span></code>: <code class="docutils literal"><span class="pre">&quot;bool&quot;</span></code></li>
<li><code class="docutils literal"><span class="pre">float</span></code>: <code class="docutils literal"><span class="pre">&quot;float&quot;</span></code></li>
<li><code class="docutils literal"><span class="pre">bytes</span></code>: <code class="docutils literal"><span class="pre">&quot;bytes&quot;</span></code></li>
<li><code class="docutils literal"><span class="pre">dict</span></code>: <code class="docutils literal"><span class="pre">&quot;json&quot;</span></code></li>
<li><code class="docutils literal"><span class="pre">list</span></code>: <code class="docutils literal"><span class="pre">&quot;json&quot;</span></code></li>
</ul>
<p>Because it is possible to convert all data types to one of
these it is possible to store any kind of data.</p>
</div>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id9">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<div class="section" id="without-a-python-module">
<h3><a class="toc-backref" href="#id10">Without a Python Module</a><a class="headerlink" href="#without-a-python-module" title="Permalink to this headline">¶</a></h3>
<p>ljson is designed to work without any third party python
modules. One can read ljson data with the python built-in
json module:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">json</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ljson</span> <span class="o">=</span> <span class="s1">&#39;{&quot;id&quot;: 1, &quot;name&quot;: &quot;foo&quot;}</span><span class="se">\n</span><span class="s1">{&quot;id&quot;: 2, &quot;name&quot;: &quot;bar&quot;}&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">ljson</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">line</span><span class="p">))</span>
<span class="gp">...</span>
<span class="go">{&#39;name&#39;: &#39;foo&#39;, &#39;id&#39;: 1}</span>
<span class="go">{&#39;name&#39;: &#39;bar&#39;, &#39;id&#39;: 2}</span>
</pre></div>
</div>
<p>And this should always be the preferred way to access ljson
data, if all data is required.</p>
<p>If one wants to access specific fields it is better to use
the ljson python module:</p>
</div>
<div class="section" id="with-the-ljson-module">
<h3><a class="toc-backref" href="#id11">With the ljson Module</a><a class="headerlink" href="#with-the-ljson-module" title="Permalink to this headline">¶</a></h3>
<p>Using the ljson Module is simple and efficient if one wants
to access just some fields, not the complete file.</p>
<p>There are two base implementations: <code class="docutils literal"><span class="pre">ljson.base.mem</span></code> that
loads the file content into the RAM. This is way faster and
supports files without a header and one is able to construct
the Table without a file.</p>
<p>The second implementation is <code class="docutils literal"><span class="pre">ljson.base.disk</span></code>. This
implementation does not load any data into RAM. If you are
accessing huge sets you should use this implementation.</p>
<p>Creating a table is simple (at least for the memory
tables):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ljson</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">header</span> <span class="o">=</span> <span class="n">ljson</span><span class="o">.</span><span class="n">Header</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;int&quot;</span><span class="p">,</span> <span class="s2">&quot;modifiers&quot;</span><span class="p">:[</span><span class="s2">&quot;unique&quot;</span><span class="p">]},</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="s2">&quot;modifiers&quot;</span><span class="p">:</span> <span class="p">[]}})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">ljson</span><span class="o">.</span><span class="n">Table</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="p">[{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;foo&quot;</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;bar&quot;</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;bar&quot;</span><span class="p">}])</span>
</pre></div>
</div>
<p>One can access items using python&#8217;s built-in <code class="docutils literal"><span class="pre">__getitem__</span></code>
and <code class="docutils literal"><span class="pre">__setitem__</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="p">[{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
<span class="go">[&#39;foo&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">table</span><span class="p">[{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}])</span>
<span class="go">[{&#39;name&#39;: &#39;foo&#39;, &#39;id&#39;: 1}]</span>
</pre></div>
</div>
<p>The table &#8220;index&#8221; must be a dict. This allows to access
non-unique rows, like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">table</span><span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;bar&quot;</span><span class="p">}])</span>
<span class="go">[{&#39;id&#39;: 2, &#39;name&#39;: &#39;bar&#39;}, {&#39;id&#39;: 3, &#39;name&#39;: &#39;bar&#39;}]</span>
</pre></div>
</div>
</div>
<div class="section" id="using-ljson-to-store-data">
<h3><a class="toc-backref" href="#id12">Using ljson to store data</a><a class="headerlink" href="#using-ljson-to-store-data" title="Permalink to this headline">¶</a></h3>
<p>Using ljson to store data is pretty simple:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fout</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">fout</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fout</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fout</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="go">&#39;{&quot;name&quot;: {&quot;type&quot;: &quot;str&quot;, &quot;modifiers&quot;: []}, &quot;__type__&quot;: &quot;header&quot;, &quot;id&quot;: {&quot;type&quot;: &quot;int&quot;, &quot;modifiers&quot;: [&quot;unique&quot;]}}\n{&quot;name&quot;: &quot;foo&quot;, &quot;id&quot;: 1}\n{&quot;name&quot;: &quot;bar&quot;, &quot;id&quot;: 2}\n{&quot;name&quot;: &quot;bar&quot;, &quot;id&quot;: 3}&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fout</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table2</span> <span class="o">=</span> <span class="n">ljson</span><span class="o">.</span><span class="n">Table</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">fout</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">table2</span><span class="p">)</span>
<span class="go">[{&#39;id&#39;: 1, &#39;name&#39;: &#39;foo&#39;}, {&#39;id&#39;: 2, &#39;name&#39;: &#39;bar&#39;}, {&#39;id&#39;: 3, &#39;name&#39;: &#39;bar&#39;}]</span>
</pre></div>
</div>
<p>Reading and writing csv files is pretty simple, too:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ljson.convert.csv</span> <span class="kn">import</span> <span class="n">table2csv</span><span class="p">,</span> <span class="n">csv2table</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fout</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table2csv</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">fout</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fout</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fout</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="go">&#39;id,name\r\n1,foo\r\n2,bar\r\n3,bar\r\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fout</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table2</span> <span class="o">=</span> <span class="n">csv2table</span><span class="p">(</span><span class="n">fout</span><span class="p">,</span> <span class="n">types</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;int&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;str&quot;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">table2</span><span class="p">)</span>
<span class="go">[{&#39;id&#39;: 1, &#39;name&#39;: &#39;foo&#39;}, {&#39;id&#39;: 2, &#39;name&#39;: &#39;bar&#39;}, {&#39;id&#39;: 3, &#39;name&#39;: &#39;bar&#39;}]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="todos">
<h2><a class="toc-backref" href="#id13">Todos</a><a class="headerlink" href="#todos" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>store bytes as b64</li>
<li>fix the sql bytes representation</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">ljson &#8211; Line JSON</a><ul>
<li><a class="reference internal" href="#quicklinks">Quicklinks</a></li>
<li><a class="reference internal" href="#build-and-test-status">Build and Test Status</a></li>
<li><a class="reference internal" href="#what-is-ljson">What is ljson?</a></li>
<li><a class="reference internal" href="#why-ljson">Why ljson?</a></li>
<li><a class="reference internal" href="#design">Design</a><ul>
<li><a class="reference internal" href="#header">Header</a></li>
<li><a class="reference internal" href="#datatypes">Datatypes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#usage">Usage</a><ul>
<li><a class="reference internal" href="#without-a-python-module">Without a Python Module</a></li>
<li><a class="reference internal" href="#with-the-ljson-module">With the ljson Module</a></li>
<li><a class="reference internal" href="#using-ljson-to-store-data">Using ljson to store data</a></li>
</ul>
</li>
<li><a class="reference internal" href="#todos">Todos</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Welcome to lson&#8217;s documentation!</a></li>
      <li>Next: <a href="guide/guide.html" title="next chapter">Quickstart</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="sources/README.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Daniel Knüttel.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="sources/README.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>